<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <title>Application Requirements — BeSafe (Alerta Ambiental)</title>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;line-height:1.55;margin:2rem;max-width:1000px}
    h1,h2{margin-top:1.25rem}
    ul{margin-left:1.25rem}
    .mockup{border:1px solid #ddd;padding:1rem;border-radius:8px;background:#fafafa;margin:1rem 0}
    code{background:#f6f8fa;padding:.2rem .4rem;border-radius:4px}
  </style>
</head>
<body>
  <h1>Application Requirements — BeSafe (Alerta Ambiental)</h1>

  <section>
    <h2>1. Resumen</h2>
    <p><strong>BeSafe</strong> integra tres datasets abiertos de Madrid — <em>Meteorología en tiempo real/acumulado</em>, <em>Episodios de ozono</em> y <em>Calidad del aire (datos horarios desde 2001)</em> — para <strong>avisar a la ciudadanía</strong> cuando no es recomendable realizar deporte al aire libre por picos de <strong>O₃/NO₂/PM</strong>. La app ofrece un mapa de estaciones, un panel horario por contaminante y un “<em>semáforo de riesgo</em>” configurable por usuario.</p>
  </section>

  <section>
    <h2>2. Alcance</h2>
    <ul>
      <li><strong>Incluye:</strong> carga de CSV locales, unificación por estación/fecha-hora, visualización en mapa y panel horario (24–72h), detección de superación de umbrales y alertas in-app.</li>
      <li><strong>Excluye:</strong> autenticación/usuarios persistentes, notificaciones push/SMS, predicción meteorológica, scraping externo, app nativa móvil.</li>
    </ul>
  </section>

  <section>
    <h2>3. Actores y Casos de Uso</h2>
    <ul>
      <li><strong>Actor:</strong> Ciudadano/a (runner, familias, personas sensibles).</li>
      <li><strong>CU1:</strong> Ver si hoy a una hora concreta es seguro correr en su zona (semáforo por contaminante).</li>
      <li><strong>CU2:</strong> Consultar mapa de estaciones con último valor por contaminante y tendencia 24–72h.</li>
      <li><strong>CU3:</strong> Recibir un aviso visual cuando se superen umbrales configurables.</li>
      <li><strong>CU4:</strong> Ver episodios oficiales activos (intervalo y medidas) y su relación con las series.</li>
    </ul>
  </section>

  <section>
    <h2>4. Requisitos Funcionales (FR)</h2>
    <ol>
      <li><strong>FR1:</strong> Cargar y validar CSV de <em>meteorología</em>, <em>calidad del aire horaria</em> y <em>episodios de ozono</em>.</li>
      <li><strong>FR2:</strong> Integrar datos por <code>código_estación</code> y <code>fecha-hora</code>; homogeneizar unidades y magnitudes.</li>
      <li><strong>FR3:</strong> Mapa con estaciones y marcador por contaminante (último valor válido y estado semáforo).</li>
      <li><strong>FR4:</strong> Panel horario (24–72h) por estación/contaminante con cálculo de semáforo por hora.</li>
      <li><strong>FR5:</strong> Mostrar episodios oficiales (inicio/fin y medidas) y resaltar horas afectadas.</li>
      <li><strong>FR6:</strong> Configurar umbrales locales por contaminante (verde/ámbar/rojo) y disparar alerta in-app.</li>
      <li><strong>FR7:</strong> Exportar datos filtrados a CSV (opcional) y registrar fecha/hora de actualización.</li>
    </ol>
  </section>

  <section>
    <h2>5. Requisitos No Funcionales (NFR)</h2>
    <ul>
      <li><strong>NFR1 (Accesibilidad):</strong> Cumplir AA (contraste, foco, texto alternativo). Responsive móvil/desktop.</li>
      <li><strong>NFR2 (Rendimiento):</strong> Carga de vistas &lt; 2 s con ficheros de muestra; operaciones básicas en memoria.</li>
      <li><strong>NFR3 (Calidad de datos):</strong> Usar solo valores con validación <code>V</code> (en los “*-updated.csv” se han eliminado Vxx y se dejan vacíos cuando no son válidos).</li>
      <li><strong>NFR4 (Licencias y atribución):</strong> Mostrar fuente “Ayuntamiento de Madrid – Datos Abiertos” y fecha de datos.</li>
      <li><strong>NFR5 (Trazabilidad):</strong> Versionado en GitHub; scripts y CSV en carpetas dedicadas.</li>
    </ul>
  </section>

  <section>
    <h2>6. Requisitos de Datos</h2>
    <ul>
      <li><strong>Meteorología:</strong> <code>PROVINCIA</code>, <code>MUNICIPIO</code>, <code>ESTACION</code>, <code>MAGNITUD</code>, <code>PUNTO_MUESTREO</code>, <code>ANO</code>, <code>MES</code>, <code>DIA</code>, <code>H01..H24</code> con <code>V01..V24</code> en el CSV original. <em>En “*-updated.csv” se usan solo Hxx con Vxx=<code>V</code> y se eliminan las columnas de validación.</em></li>
      <li><strong>Calidad del aire (horaria):</strong> mismo esquema que meteorología (H01..H24 y V01..V24 en origen). <em>En “*-updated.csv” quedan únicamente las Hxx válidas, sin columnas Vxx.</em></li>
      <li><strong>Episodios de ozono:</strong> <code>FECHA INICIO</code>, <code>FECHA FIN</code>, <code>EPISODIO OZONO</code>, <code>MEDIDA POBLACION</code>. (Fechas normalizadas a ISO 8601 cuando aplica).</li>
      <li><strong>Estrategia de enlace:</strong> unión por <em>código de estación</em> + <em>fecha-hora</em> (meteorología/calidad aire) y solape temporal con <em>episodios</em>; coordenadas para mapa (si procede).</li>
    </ul>
  </section>

  <section>
    <h2>7. Mock-ups (baja fidelidad)</h2>
    <div class="mockup">
      <h3>Home / Mapa</h3>
      <p>Mapa con capas: Estaciones (último valor O₃/NO₂/PM), selector de contaminante y filtro temporal; tarjeta lateral con semáforo actual.</p>
    </div>
    <div class="mockup">
      <h3>Detalle estación</h3>
      <p>Serie 24–72h por contaminante, semáforo por hora, y bloque de contexto: viento/temperatura y episodios solapados.</p>
    </div>
    <div class="mockup">
      <h3>Episodios activos</h3>
      <p>Listado de episodios (inicio/fin y medidas) con resaltado de horas afectadas en la serie.</p>
    </div>
  </section>

  <section>
    <h2>8. Criterios de Aceptación</h2>
    <ul>
      <li><strong>FR1:</strong> Dado un CSV válido, cuando se importe, entonces el sistema muestra el nº de filas cargadas y detecta columnas esperadas.</li>
      <li><strong>FR3:</strong> Dado el mapa cargado, cuando selecciono O₃, entonces cada estación muestra el último valor válido y color del semáforo.</li>
      <li><strong>FR4:</strong> Dada una estación, cuando abro su detalle, entonces veo la serie horaria (24–72h) con colores por hora según umbral.</li>
      <li><strong>FR5:</strong> Dado un episodio activo, cuando su intervalo solapa con horas de la serie, entonces esas horas aparecen resaltadas.</li>
      <li><strong>FR6:</strong> Dado que configuro NO₂ rojo ≥ 200 µg/m³, cuando un valor horario alcanza 200 o más, entonces aparece una alerta visual.</li>
      <li><strong>FR7:</strong> Dado un filtro aplicado, cuando exporto, entonces descargo un CSV con las filas visibles y metadatos mínimos (fecha de exportación).</li>
    </ul>
  </section>
</body>
</html>

